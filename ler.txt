Para melhorar a auditoria e controlar o acesso dos usuários com privilégios especiais (como administradores de servidores) no Active Directory (AD), é essencial implementar uma série de políticas e práticas que garantam que o ambiente esteja seguro e que você tenha visibilidade sobre as ações realizadas por esses usuários.

Aqui estão as principais políticas e melhores práticas que você pode adotar para fortalecer a auditoria no seu AD:

### 1. **Princípio do Menor Privilégio**

* **Definição**: Atribua permissões apenas no nível necessário para que o usuário desempenhe sua função. Para administradores de servidores, forneça acesso ao mínimo necessário, como permissões específicas em determinados servidores.
* **Exemplo**: Use grupos de segurança para fornecer permissões para tarefas específicas, como "Administradores de Servidor", sem conceder privilégios administrativos globais.

### 2. **Auditoria de Logon e Logoff (Configuração de Log)**

* **Ativar a Auditoria de Logon/Logoff**: Você pode configurar a auditoria de eventos de logon (tanto bem-sucedidos quanto falhados) e logoff através das **Políticas de Auditoria de Segurança** no Active Directory.

  * **Configuração**:

    1. No **Group Policy Management**, edite a GPO que aplica a política de segurança.
    2. Acesse **Configuração do Computador** → **Políticas** → **Configurações de Windows** → **Configurações de Segurança** → **Políticas Locais** → **Política de Auditoria**.
    3. Ative as opções de **Auditoria de Logon/Logoff** (sucesso e falha).

  * **Eventos a serem auditados**:

    * **Event ID 4624** (Logon bem-sucedido)
    * **Event ID 4634** (Logoff)
    * **Event ID 4768** (Logon via Kerberos)
    * **Event ID 4776** (Falha no logon)

* **Objetivo**: Para que você saiba quando um superusuário faz logon no sistema e quando ele realiza o logoff.

### 3. **Auditoria de Alterações no AD (Gerenciamento de Identidade)**

* **Ativar Auditoria de Modificações de Objetos**: Para rastrear alterações em usuários, grupos e permissões no AD, é necessário ativar a auditoria de alterações no AD.
* **Configuração**:

  1. Habilite a auditoria para **modificações de objetos**. No **Group Policy Management**, configure a política para **Auditoria de Objetos**.
  2. Habilite a opção de **auditoria de acesso a objetos** no AD. Isso pode ser feito em **Active Directory Users and Computers**, clicando com o botão direito no domínio e indo para **Propriedades** → **Política de Auditoria**.
* **Eventos a serem auditados**:

  * **Event ID 5136**: Modificação de atributos de um objeto.
  * **Event ID 5137**: Criação de um objeto no AD.
  * **Event ID 5141**: Exclusão de um objeto do AD.
* **Objetivo**: Você poderá auditar quaisquer alterações feitas nas permissões de usuários, ou a inclusão/exclusão de grupos e atribuições de privilégios.

### 4. **Use do "Privileged Access Management" (PAM)**

* **Implementar PAM (Privileged Access Management)**: Ferramentas como o **Microsoft PAM** permitem um controle detalhado do acesso de privilégios elevados, gerenciando os privilégios de usuários de maneira dinâmica e temporária.

  * **Exemplo**: Apenas conceder privilégios elevados para tarefas específicas, com o uso de senhas temporárias ou com a autenticação de múltiplos fatores (MFA).

### 5. **Política de Senhas**

* **Requisitos Rigorosos para Senhas**: Estabeleça políticas rígidas para senhas de superusuários. Isso inclui o uso de senhas fortes, com comprimento adequado e complexidade.

  * **Configuração**: Vá para **GPO (Group Policy Objects)** → **Configuração de Computador** → **Configurações de Windows** → **Configurações de Segurança** → **Políticas de Senha**.
* **Configuração de MFA**: Para os usuários com privilégios especiais, é recomendável implementar a **autenticação multifatorial** (MFA) sempre que possível.

### 6. **Acesso Restrito a Ferramentas de Administração**

* **Regras para o Uso de Ferramentas de Administração**: Ferramentas como o **Remote Desktop** ou **PowerShell Remoting** podem ser configuradas de forma a exigir autenticação adicional ou um processo de aprovação para usuários com privilégios administrativos.

* **Exemplo**: Defina **políticas de uso de RDP** (Remote Desktop Protocol) apenas em máquinas específicas e garanta que os administradores não usem credenciais padrão.

### 7. **Implementar Delegação de Controle com o "Delegation of Control Wizard"**

* **Delegação de Controle**: Evite o uso de contas de superusuário em todos os casos. Se possível, delegue controle sobre objetos específicos do AD a grupos de administradores, permitindo que esses administradores tenham permissões limitadas e mais auditáveis.
* **Exemplo**: Delegue permissões de administração de servidores a um grupo específico, ao invés de dar permissões a um superusuário global.

### 8. **Monitoramento e Relatórios Regulares**

* **Ferramentas de Monitoramento**: Use ferramentas de **SIEM** (Security Information and Event Management) como **Splunk**, **Azure Sentinel**, ou o próprio **Event Viewer** do Windows para centralizar logs e gerar relatórios regulares.

* **Relatórios para Análise**: Crie relatórios detalhados sobre todas as atividades dos superusuários, como logons, modificações de objetos, tentativas de falha e outras ações críticas no AD.

### 9. **Uso de "Time-bound" Access (Acesso Temporário)**

* **Acesso Temporário para Administradores**: Conceda acesso elevado por períodos específicos de tempo, revogando automaticamente esse acesso após o período de necessidade.

  * **Exemplo**: O uso de contas de administrador pode ser feito com **Windows Admin Center** ou com ferramentas como **Just-in-Time (JIT) Access** no **Azure AD Privileged Identity Management (PIM)**.

### 10. **Revisões Periódicas de Acesso e Permissões**

* **Revisão Periódica**: Realize auditorias regulares e revisões de permissões para garantir que os privilégios atribuídos aos administradores estejam sempre em conformidade com as necessidades reais do trabalho. Isso inclui a remoção de privilégios de usuários que não precisam mais de acesso privilegiado.

### 11. **Segurança de Conta de Serviço**

* **Proteção das Contas de Serviço**: Assegure que as contas de serviço que executam tarefas de administrador não tenham senhas fracas ou padrões, e implemente políticas de segurança, como a rotação periódica de senhas para contas de serviço.

### Conclusão

Ao combinar essas práticas e políticas, você pode garantir que o acesso privilegiado seja controlado e monitorado adequadamente, fornecendo um alto nível de segurança e auditoria no seu ambiente Active Directory. O uso de ferramentas como **Privileged Access Management (PAM)** e **MFA** são essenciais para proteger as credenciais de administradores e para garantir que as ações desses usuários sejam auditadas de maneira eficaz.
